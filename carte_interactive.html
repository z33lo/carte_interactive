<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Carte Interactive - Villes Vertes</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <!-- MarkerCluster CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
    
    <style>
        body, html { margin: 0; padding: 0; height: 100%; }
        #map { width: 100%; height: 100%; position: relative; }

        /* Légende ancrée devant la carte */
        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            font-family: Arial, sans-serif;
            font-size: 14px;
            line-height: 1.4;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
    </style>
</head>
<body>

    <div id="map"></div>

    <!-- Légende -->
    <div class="legend">
        <div class="legend-title"><strong>Quinquennals 2019-2024</strong></div>
        <div class="legend-item">
            <div class="legend-color" style="background:orangered;"></div> Communications internationnales
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:darkblue;"></div> Co-auteur/Co-autrice
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <!-- MarkerCluster JS -->
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

    <script>
        // Carte centrée avec zoom libre
        var map = L.map('map').setView([20, 0], 3);

        // Fond de carte OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18
        }).addTo(map);

        // Créer le groupe de clusters 
        var markersCluster = L.markerClusterGroup();

        // Liste des villes avec une participation colloque avec latitude et longitude approximatives
        var villesColloques = [
            { name: "Manchester", lat: 53.4808, lon: -2.2426 },
            { name: "Ben Guerir", lat: 32.3210, lon: -7.9931 },
            { name: "Berlin", lat: 52.5200, lon: 13.4050 },
            { name: "Montréal", lat: 45.5017, lon: -73.5673 },
            { name: "Sydney", lat: -33.8688, lon: 151.2093 },
            { name: "Oslo", lat: 59.9139, lon: 10.7522 },
            { name: "Rio de Janeiro", lat: -22.9068, lon: -43.1729 },
            { name: "Genève", lat: 46.2044, lon: 6.1432 },
            { name: "Dakar", lat: 14.7167, lon: -17.4677 },
            { name: "Honolulu", lat: 21.3069, lon: -157.8583 },
            { name: "Bruxelles", lat: 50.8503, lon: 4.3517 },
            { name: "Nevşehir", lat: 38.6247, lon: 34.7142 },
            { name: "Mexico City", lat: 19.4326, lon: -99.1332 },
            { name: "Gothenburg", lat: 57.7089, lon: 11.9746 },
            { name: "Québec", lat: 46.8139, lon: -71.2080 },
            { name: "Lausanne", lat: 46.5197, lon: 6.6323 },
            { name: "Nycosia", lat: 35.1856, lon: 33.3823 },
            { name: "Nitra", lat: 48.3089, lon: 18.0843 },
            { name: "Hannover", lat: 52.3759, lon: 9.7320 },
            { name: "Namur", lat: 50.4669, lon: 4.8675 },
            { name: "Bolzano", lat: 46.4983, lon: 11.3548 },
            { name: "Cholula", lat: 19.0522, lon: -98.3022 },
            { name: "Rabat", lat: 34.0209, lon: -6.8417 },
            { name: "Linköping", lat: 58.4108, lon: 15.6214 },
            { name: "Cotonou", lat: 6.3703, lon: 2.3912 },
            { name: "Laval", lat: 45.6066, lon: -73.7124 },
            { name: "Vienne", lat: 48.2082, lon: 16.3738 },
            { name: "Stockholm", lat: 59.3293, lon: 18.0686 },
            { name: "Le Caire", lat: 30.0444, lon: 31.2357 },
            { name: "Sherbrooke", lat: 45.4042, lon: -71.8920 },
            { name: "Shanghai", lat: 31.2304, lon: 121.4737 },
            { name: "Daegu", lat: 35.8722, lon: 128.6014 },
            { name: "Édimbourg", lat: 55.9533, lon: -3.1883 },
            { name: "Durham", lat: 54.7761, lon: -1.5753 },
            { name: "Braga", lat: 41.5454, lon: -8.4265 },
            { name: "Mazatlan", lat: 23.2494, lon: -106.4111 },
            { name: "Louvain", lat: 50.8798, lon: 4.7005 },
            { name: "Turin", lat: 45.0703, lon: 7.6869 },
            { name: "Prague", lat: 50.0755, lon: 14.4378 },
            { name: "Lisbon", lat: 38.7169, lon: -9.1390 },
            { name: "Nicosia", lat: 35.1856, lon: 33.3823 },
            { name: "Porto", lat: 41.1579, lon: -8.6291 },
            { name: "Bizerte", lat: 37.2746, lon: 9.8739 },
            { name: "Ciudad Real", lat: 38.9860, lon: -3.9275 },
            { name: "Gatineau", lat: 45.4765, lon: -75.7013 },
            { name: "Tunis", lat: 36.8065, lon: 10.1815 },
            { name: "Utrecht", lat: 52.0907, lon: 5.1214 },
            { name: "Zaragoza", lat: 41.6488, lon: -0.8891 },
            { name: "Marrakech", lat: 31.6295, lon: -7.9811 },
            { name: "Hammamet", lat: 36.4020, lon: 10.6220 },
            { name: "Birmingham", lat: 52.4862, lon: -1.8904 }
        ];

        // Ajouter tous les marqueurs avec tooltip au survol
        villesColloques.forEach(function(v) {
            var tooltipHTML = "<strong>" + v.name + "</strong>";
            L.circleMarker([v.lat, v.lon], {
                radius: 6,
                color: 'orangered',
                fillColor: 'orangered',
                fillOpacity: 1
            })
            .addTo(map)
            .bindTooltip(tooltipHTML, { permanent: false });
        });

        // Liste des villes des co-auteur/co-autrice avec leur universite et latitude et longitude approximatives
        var villesCoredaction = [
            {name: "Yaounde", uni: "University of Yaoundé", lat: 3.8480, lon: 11.5021},
            {name: "Rio de Janeiro", uni: "Universidade Federal Rural do Rio de Janeiro", lat: -22.9068, lon: -43.1729},
            {name: "Bamako", uni: "École normale supérieure de Bamako", lat: 12.6392, lon: -8.0029},
            {name: "Lausanne", uni: "HEP Lausanne", lat: 46.5197, lon: 6.6323},
            {name: "Shangaï", uni: "East China Normal University", lat: 31.2304, lon: 121.4737},
            {name: "Bristol", uni: "University of Bristol", lat: 51.4545, lon: -2.5879},
            {name: "Eindhoven", uni: "Eindhoven University of Technology", lat: 51.4416, lon: 5.4697},
            {name: "Beyrouth", uni: "Lebanese American University", lat: 33.8886, lon: 35.4955},
            {name: "Gatineau", uni: "Université du Québec en Outaouais", lat: 45.4765, lon: -75.7013},
            {name: "Montréal", uni: "Université du Québec à Montréal", lat: 45.5017, lon: -73.5673},
            {name: "Toronto", uni: "Canadian Institute for Military and Veteran Health Research", lat: 43.6532, lon: -79.3832},
            {name: "Tunis", uni: "Université de Tunis El Manar", lat: 36.8065, lon: 10.1815},
            {name: "Rome", uni: "Sapienza University", lat: 41.9028, lon: 12.4964},
            {name: "Duisburg", uni: "Universität Duisburg-Essen", lat: 51.4344, lon: 6.7623},
            {name: "Beersheba", uni: "University of the Negev", lat: 31.2518, lon: 34.7913},
            {name: "Mons", uni: "Université de Mons-Hainaut", lat: 50.4540, lon: 3.9560},
            {name: "Lausanne", uni: "University of Lausanne", lat: 46.5197, lon: 6.6323},
            {name: "Athens", uni: "National and Kapodistrian University of Athens", lat: 37.9838, lon: 23.7275},
            {name: "Turin", uni: "University of Turin", lat: 45.0703, lon: 7.6869},
            {name: "Armidale", uni: "University of New England", lat: -30.5016, lon: 151.6675},
            {name: "Eindhoven", uni: "Technische Universiteit Eindhoven", lat: 51.4416, lon: 5.4697},
            {name: "Fribourg", uni: "University of Fribourg", lat: 46.8065, lon: 7.1617},
            {name: "La Haye", uni: "The Netherlands Organisation for Applied Scientific Research", lat: 52.0705, lon: 4.3007},
            {name: "Recife", uni: "Universidade Federal de Pernambuco", lat: -8.0476, lon: -34.8770}
        ];

        // On va regrouper les villes avec le même nom
        var villesCoredactionMap = {};
        villesCoredaction.forEach(function(v){
            if(!villesCoredactionMap[v.name]) {
                villesCoredactionMap[v.name] = {lat: v.lat, lon: v.lon, unis: [v.uni]};
            } else {
                villesCoredactionMap[v.name].unis.push(v.uni);
            }
        });

        // Ajouter les marqueurs avec tooltip au survol
        Object.keys(villesCoredactionMap).forEach(function(city){
            var v = villesCoredactionMap[city];
            // Créer le contenu du tooltip
            var tooltipHTML = "<strong>" + city + "</strong><br>" + v.unis.join("<br>");
            L.circleMarker([v.lat, v.lon], {
                radius: 6,
                color: 'darkblue',
                fillColor: 'darkblue',
                fillOpacity: 1
            }).addTo(map)
            .bindTooltip(tooltipHTML, { permanent: false, direction: 'top' });
        });

    </script>

    

</body>
</html>
